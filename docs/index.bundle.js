(self.webpackChunkhexagon_board=self.webpackChunkhexagon_board||[]).push([[826],{426:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var r=n(81),a=n.n(r),i=n(645),o=n.n(i)()(a());o.push([t.id,"* {\n  margin: 0;\n  padding: 0;\n  box-sizing: border-box;\n}\n\nbody {\n  overflow: hidden;\n}\n\n#app {\n  width: 100%;\n  min-height: 100vh;\n  position: relative;\n}\n\n#app canvas {\n  width: 100%;\n  height: 100%;\n  background-color: black;\n}\n\n#btn-start {\n  position: absolute;\n  top: 10px;\n  left: 50%;\n  transform: translateX(-50%);\n  padding: 10px 20px;\n  font-size: 36px;\n  line-height: 44px;\n}",""]);const s=o},645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",r=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),r&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),r&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,r,a,i){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(r)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(o[c]=!0)}for(var u=0;u<t.length;u++){var l=[].concat(t[u]);r&&o[l[0]]||(void 0!==i&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=i),n&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=n):l[2]=n),a&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=a):l[4]="".concat(a)),e.push(l))}},e}},81:t=>{"use strict";t.exports=function(t){return t[1]}},379:t=>{"use strict";var e=[];function n(t){for(var n=-1,r=0;r<e.length;r++)if(e[r].identifier===t){n=r;break}return n}function r(t,r){for(var i={},o=[],s=0;s<t.length;s++){var c=t[s],u=r.base?c[0]+r.base:c[0],l=i[u]||0,h="".concat(u," ").concat(l);i[u]=l+1;var f=n(h),d={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==f)e[f].references++,e[f].updater(d);else{var p=a(d,r);r.byIndex=s,e.splice(s,0,{identifier:h,updater:p,references:1})}o.push(h)}return o}function a(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,a){var i=r(t=t||[],a=a||{});return function(t){t=t||[];for(var o=0;o<i.length;o++){var s=n(i[o]);e[s].references--}for(var c=r(t,a),u=0;u<i.length;u++){var l=n(i[u]);0===e[l].references&&(e[l].updater(),e.splice(l,1))}i=c}}},569:t=>{"use strict";var e={};t.exports=function(t,n){var r=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},216:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},565:(t,e,n)=>{"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},795:t=>{"use strict";t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var a=void 0!==n.layer;a&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,a&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleTagTransform(r,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},589:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},601:()=>{HEX_SIZE=50},699:(t,e,n)=>{"use strict";var r,a,i;n.d(e,{Ab:()=>i,Rv:()=>a,ZP:()=>o}),function(t){t.STR="strength",t.AGI="agility",t.VIT="vitality",t.INT="intellegent",t.RAN="attack_range"}(a||(a={})),function(t){t.HP="health_point",t.MP="mana_point",t.PD="physical_damgage",t.MD="magical_damage",t.AS="attack_speed",t.MS="movement_speed"}(i||(i={}));const o={COMPLEX_STAT_FORMULA:((r={})[i.HP]="{".concat(a.VIT,"} * 10"),r[i.MP]="{".concat(a.INT,"} * 10"),r[i.PD]="{".concat(a.STR,"} * 3"),r[i.MD]="{".concat(a.INT,"} * 3"),r[i.AS]="{".concat(a.AGI,"} * 1.5"),r[i.MS]="{".concat(a.AGI,"} * 1"),r)}},76:(t,e,n)=>{"use strict";var r=[{q:1,r:0},{q:1,r:-1},{q:0,r:-1},{q:-1,r:0},{q:-1,r:1},{q:0,r:1}],a=[2,3,4],i=function(t,e){return{q:t.q+e.q,r:t.r+e.r}},o=function(t,e){return{q:t.q-e.q,r:t.r-e.r}},s=function(t,e){return(null==t?void 0:t.r)===(null==e?void 0:e.r)&&(null==t?void 0:t.q)===(null==e?void 0:e.q)},c=function(t,e){return i(t,function(t){return r[t]}(e))},u=function(t){for(var e=[],n=0;n<6;n++)e.push(c(t,n));return e},l=function(){return HEX_SIZE*cam.zoom},h=function(t){return{q:t.q,r:t.r}},f=function(t){var e=t.q,n=t.r;return{q:e,r:n,s:-e-n}},d=function(t){var e=Math.round(t.q),n=Math.round(t.r),r=Math.round(t.s),a=Math.abs(e-t.q),i=Math.abs(n-t.r),o=Math.abs(r-t.s);return a>i&&a>o?e=-n-r:i>o?n=-e-r:r=-e-n,{q:e,r:n,s:r}},p=function(t){return h(d(f(t)))},v=function(t){return{x:t.r,y:t.q+Math.floor(t.r/2)}},m={axialAdd:i,axialSubtract:o,axialEqual:s,axialIsLeft:function(t,e){var n=o(t,e),i=r.findIndex((function(t){return s(t,n)}));return a.includes(i)},axialDistance:function(t,e){var n=o(t,e);return(Math.abs(n.q)+Math.abs(n.q+n.r)+Math.abs(n.r))/2},axialNeighbor:c,getAxialNeighbors:u,cubeToAxial:h,axialToCube:f,cubeRound:d,axialRound:p,pixelToHex:function(t){var e=(Math.sqrt(3)/3*t.x-1/3*t.y)/l(),n=2/3*t.y/l();return p({q:e,r:n})},hexToPixel:function(t){return{x:HEX_SIZE*(Math.sqrt(3)*t.q+Math.sqrt(3)/2*t.r),y:HEX_SIZE*(1.5*t.r)}},axialToStore:v,lerp:function(t,e,n){return t+(e-t)*n},isNeighbor:function(t,e){return u(e).some((function(e){return s(t,e)}))},isInRange:function(t,e,n){var r=o(t,e);return Math.abs(r.r)<=n&&Math.abs(r.q)<=n},isExistOnBoard:function(t,e){var n=v(e),r=n.x,a=n.y;return!(r<0||r>=t.length||a<0||a>=t[r].length)}};const b=m;var y={init:function(t){for(var e=0;e<t.length;e++)for(var n=0;n<t[e].length;n++)t[e][n].f=0,t[e][n].g=0,t[e][n].h=0,t[e][n].debug=0,t[e][n].parent=null,t[e][n].neighbors=[];for(e=0;e<t.length;e++)for(n=0;n<t[e].length;n++)for(var r=0,a=b.getAxialNeighbors(t[e][n]);r<a.length;r++){var i=a[r],o=b.axialToStore(i),s=o.x,c=o.y;s<0||s>=t.length||c>=t[e].length||c<0||t[s][c].block||t[e][n].neighbors.push(t[s][c])}return t},getBoardHex:function(t,e){var n=b.axialToStore(t),r=n.x,a=n.y;return e[r][a]},search:function(t,e,n){var r=y.init(t),a=y.getBoardHex(e,r),i=y.getBoardHex(n,r),o=[],s=[],c=[];for(o.push(a);o.length;){for(var u=0,l=0;l<o.length;l++)o[l].f<o[u].f&&(u=l);var h=o[u];if(b.axialEqual(h,i)){var f=h;for(c.push(f);f.parent;)c.push(f.parent),f=f.parent;return c.reverse()}o.splice(u,1),s.push(h);var d=h.neighbors;for(l=0;l<d.length;l++){var p=d[l];if(!s.includes(p)){var v=h.g+1;if(o.includes(p)){if(v>=p.g)continue}else o.push(p);p.g=v,p.h=b.axialDistance(p,i),p.f=p.g+p.h,p.parent=h}}}return[]}};const x=y;var g;!function(t){t.GREEN="green",t.RED="red",t.BLUE="blue"}(g||(g={}));const w=g;var _=function(){return _=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},_.apply(this,arguments)},T=function(t){return"object"!=typeof t||Object.keys(t).forEach((function(e){(void 0===t[e]||Number.isNaN(t[e]))&&delete t[e]})),t};const E=_(_({},{getRandomColor:function(){var t=Object.values(w);return t[Math.round(Math.random()*t.length)]||"white"}}),{objFilterNaN:T});var S=function(){return S=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},S.apply(this,arguments)},A={focus:function(t){var e=canvas.width,r=canvas.height;n.g.cam={x:t.x-e/2,y:t.y-r/2,zoom:1,width:e,height:r}},move:function(t){n.g.cam=S(S({},n.g.cam),{x:n.g.cam.x+t.x,y:n.g.cam.y+t.y})},zoom:function(t){t.offsetX,t.offsetY;var e=t.deltaY,r=cam.zoom*(1+.05*Math.sign(e));n.g.cam=S(S({},n.g.cam),{zoom:r})},inCam:function(t){if("number"==typeof t)return t*cam.zoom;var e=t,n=e.x,r=e.y,a=e.width,i=e.height,o=e.size,s={x:(n-cam.x)*cam.zoom,y:(r-cam.y)*cam.zoom,width:a*cam.zoom,height:i*cam.zoom,size:o*cam.zoom};return T(s)},mouseCam:function(t){return S(S({},t),{x:t.offsetX+cam.x*cam.zoom,y:t.offsetY+cam.y*cam.zoom})}};const k=A;document.getElementById("sprite");var M=2*Math.PI/6,C={clearScreen:function(){ctx.clearRect(0,0,canvas.width,canvas.height)},drawHex:function(t,e){void 0===e&&(e="white");var n=k.inCam(t),r=n.x,a=n.y,i=n.size;ctx.beginPath();for(var o=0;o<6;o++)ctx.lineTo(r+i*Math.sin(M*o),a+i*Math.cos(M*o));ctx.closePath(),ctx.fillStyle=e,ctx.fill()},strokeHex:function(t,e,n){void 0===e&&(e=1),void 0===n&&(n="white");var r=k.inCam(t),a=r.x,i=r.y,o=r.size,s=k.inCam(e);o-=e/2,ctx.beginPath();for(var c=0;c<6;c++)ctx.lineTo(a+o*Math.sin(M*c),i+o*Math.cos(M*c));ctx.closePath(),ctx.save(),ctx.strokeStyle=n,ctx.lineWidth=s,ctx.stroke(),ctx.restore()},drawRect:function(t){var e=k.inCam(t),n=e.x,r=e.y,a=e.width,i=e.height;ctx.fillStyle="white",ctx.fillRect(n,r,a,i)},drawText:function(t,e,n){void 0===n&&(n="black");var r=k.inCam(e),a=r.x,i=r.y;ctx.font="20px Arial",ctx.fillStyle=n,ctx.fillText(t,a,i)},drawImage:function(t,e,n,r,a){void 0===n&&(n=0),void 0===r&&(r=0),void 0===a&&(a=1);var i=k.inCam(e),o=i.x,s=i.y,c=k.inCam(HEX_SIZE/720*4);ctx.save(),-1===a?(ctx.translate(o+720*c/2,s-740*c/2),ctx.scale(-1,1)):ctx.translate(o-720*c/2,s-740*c/2),ctx.drawImage(t,720*n,490*r,720,490,0,0,720*c,490*c),ctx.restore()}};const P=C;var q,I=n(699);const R={DEFAULT_STAT:((q={})[I.Rv.STR]=1,q[I.Rv.AGI]=1,q[I.Rv.VIT]=1,q[I.Rv.INT]=1,q[I.Rv.RAN]=1,q)};var O=n(322),L=n(634),D=function(t,e){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(o=0)),o;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},F={startCoroutine:function(t){return new Promise((function(e,n){var r={generator:t(),onDone:function(){return e()}};animCallback.push(r)}))},sleep:function(t){return e=void 0,r=void 0,i=function(){return D(this,(function(e){switch(e.label){case 0:return[4,F.startCoroutine((function(){var e;return D(this,(function(r){switch(r.label){case 0:e=0,r.label=1;case 1:return e>=t?[3,3]:(e+=n.g.deltaTime,[4,null]);case 2:return r.sent(),[3,1];case 3:return[2]}}))}))];case 1:return e.sent(),[2]}}))},new((a=void 0)||(a=Promise))((function(t,n){function o(t){try{c(i.next(t))}catch(t){n(t)}}function s(t){try{c(i.throw(t))}catch(t){n(t)}}function c(e){var n;e.done?t(e.value):(n=e.value,n instanceof a?n:new a((function(t){t(n)}))).then(o,s)}c((i=i.apply(e,r||[])).next())}));var e,r,a,i}};const H=F;var N,z=function(t,e,n,r){return new(n||(n=Promise))((function(a,i){function o(t){try{c(r.next(t))}catch(t){i(t)}}function s(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}c((r=r.apply(t,e||[])).next())}))},K=function(t,e){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(o=0)),o;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},j=document.getElementById("sprite");!function(t){t[t.IDLE=0]="IDLE",t[t.WALK=1]="WALK",t[t.ATTACK=2]="ATTACK"}(N||(N={}));var V=function(){function t(t){var e=t.hex,n=void 0===e?null:e,r=t.dir,a=void 0===r?1:r;t.base_stats,this.frame=0,this.maxFrame=0,this.status=N.IDLE,this.dir=1,this.hex=n,this.dir=a,this.battle=n.battle,this.stats=this.initEntityBaseStat(Z()),this.calcEntityComplexStat(),this.maxFrame=12,this.initAnimate()}return t.prototype.initEntityBaseStat=function(t){return Object.entries(t).reduce((function(t,e){var n=e[0],r=e[1];return t[n]=new L.Z({name:n,value:r}),t}),{})},t.prototype.calcEntityComplexStat=function(){var t=this;Object.entries(I.Ab).forEach((function(e){e[0];var n=e[1];t.stats[n]=new O.Z({name:n,value:t.stats})}))},t.prototype.initAnimate=function(){H.startCoroutine(function(){var t,e;return K(this,(function(r){switch(r.label){case 0:t=0,r.label=1;case 1:return t+=n.g.deltaTime,e=1e3/this.maxFrame,t>e&&(t=0,this.frame+=1,this.frame>=this.maxFrame&&(this.frame=0)),[4,null];case 2:return r.sent(),[3,1];case 3:return[2]}}))}.bind(this))},t.prototype.startAnimate=function(t){switch(this.status=t,t){case N.IDLE:this.maxFrame=12,this.frame=0;break;case N.WALK:this.maxFrame=18,this.frame=0;break;case N.ATTACK:this.maxFrame=12,this.frame=0;break;default:this.maxFrame=0,this.frame=0}},t.prototype.action=function(){return z(this,void 0,void 0,(function(){var t,e,n,r=this;return K(this,(function(a){switch(a.label){case 0:return t=this.hex.team,e=t.enemiesTeam.map((function(t){return t.allies})).flat(),n=e.filter((function(t){return b.isInRange(r.hex,t,r.getFinalValue(I.Rv.RAN))})),console.log("target in range[".concat(this.getFinalValue(I.Rv.RAN),"]: "),n),n.length?[3,2]:[4,this.moveToNearestTarget(e)];case 1:a.sent(),a.label=2;case 2:return(n=e.filter((function(t){return b.isInRange(r.hex,t,r.getFinalValue(I.Rv.RAN))}))).length?[4,this.attack()]:[3,4];case 3:a.sent(),a.label=4;case 4:return[2]}}))}))},t.prototype.moveToNearestTarget=function(t){return z(this,void 0,void 0,(function(){var e,n=this;return K(this,(function(r){switch(r.label){case 0:return(e=t.reduce((function(t,e){var r=x.search(n.battle.board,n.hex,e);return r.splice(0,1),0===t.length?r.length?r:t:r.length&&r.length<t.length?r:t}),[])).length>1?(e.splice(e.length-1,1),console.log("move ".concat(this.getFinalValue(I.Ab.MS))),[4,this.hex.move(e.splice(0,this.getFinalValue(I.Ab.MS)))]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.attack=function(){return z(this,void 0,void 0,(function(){return K(this,(function(t){switch(t.label){case 0:return this.startAnimate(N.ATTACK),[4,H.sleep(1e3)];case 1:return t.sent(),this.startAnimate(N.IDLE),[2]}}))}))},t.prototype.getFinalValue=function(t){return this.stats[t].finalValue},t.prototype.render=function(){var t=b.hexToPixel(this.hex),e=t.x,n=t.y;P.drawImage(j,{x:e,y:n},this.frame,this.status,this.dir)},t}(),Z=function(){var t=R.DEFAULT_STAT,e=Math.round(2.5*(Object.keys(I.Rv).length-1)),n=0;for(var r in t){var a=Math.round(2*Math.random()+1);n+=a,t[r]=a}return t[I.Rv.AGI]=e-(n-t[I.Rv.AGI]),t[I.Rv.RAN]=1,t};const B=V;var W=function(){return W=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},W.apply(this,arguments)},G=function(t,e){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(o=0)),o;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},X=function(){function t(t){var e=t.battle,n=t.team,r=t.q,a=t.r,i=t.color,o=t.owner,s=void 0===o?null:o,c=t.block,u=void 0!==c&&c;this.color="white",this.battle=e,this.team=n,this.q=r,this.r=a,this.owner=s,this.block=u,this.color=(null==n?void 0:n.color)||i||"white"}return t.prototype.updatePos=function(t){this.r=t.r,this.q=t.q},t.prototype.move=function(t){return e=this,r=void 0,i=function(){function e(){var e,r,a;return G(this,(function(i){switch(i.label){case 0:if(!t.length)return[2];e=0,r=W({},this),a=t.splice(0,1)[0],this.owner.dir=b.axialIsLeft(a,r)?-1:1,i.label=1;case 1:if(this.updatePos({r:b.lerp(r.r,a.r,e/500),q:b.lerp(r.q,a.q,e/500)}),e>=500){if(e=0,r=a,!t.length)return this.updatePos(a),[3,3];a=t.splice(0,1)[0],this.owner.dir=b.axialIsLeft(a,r)?-1:1}return e+=n.g.deltaTime,[4,null];case 2:return i.sent(),[3,1];case 3:return[2]}}))}return G(this,(function(t){switch(t.label){case 0:return this.owner.startAnimate(N.WALK),[4,H.startCoroutine(e.bind(this))];case 1:return t.sent(),this.owner.startAnimate(N.IDLE),[2]}}))},new((a=void 0)||(a=Promise))((function(t,n){function o(t){try{c(i.next(t))}catch(t){n(t)}}function s(t){try{c(i.throw(t))}catch(t){n(t)}}function c(e){var n;e.done?t(e.value):(n=e.value,n instanceof a?n:new a((function(t){t(n)}))).then(o,s)}c((i=i.apply(e,r||[])).next())}));var e,r,a,i},t.prototype.render=function(){var t=b.hexToPixel(this),e=t.x,n=t.y;P.strokeHex({x:e,y:n,size:HEX_SIZE},10,this.color)},t}();const U=X;var Y=function(){return Y=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},Y.apply(this,arguments)},J=function(t,e,n,r){return new(n||(n=Promise))((function(a,i){function o(t){try{c(r.next(t))}catch(t){i(t)}}function s(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}c((r=r.apply(t,e||[])).next())}))},Q=function(t,e){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(o=0)),o;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},$=[{side:"team1",allies:[{pos:{x:0,y:1},dir:1},{pos:{x:0,y:3},dir:1},{pos:{x:0,y:5},dir:1}],color:"green",enemyTeams:["team2"]},{side:"team2",allies:[{pos:{x:7,y:1},dir:-1},{pos:{x:7,y:3},dir:-1},{pos:{x:7,y:5},dir:-1}],color:"red",enemyTeams:["team1"]}],tt=function(){function t(t){void 0===t&&(t=[]);var e=this;this.path=[],this.count=0,this.canAction=!0,this.teams={},this.board=t;for(var n=0;n<8;n++){t.length<n+1&&this.board.push([]);for(var r=0;r<10;r++)this.board[n].push(new U({battle:this,r:n,q:r-Math.floor(n/2)}))}$.forEach((function(t){var n=t.side,r=t.allies,a=t.enemyTeams,i=t.color;n in e.teams||(e.teams[n]={side:n,allies:[],enemiesTeam:[],color:i||E.getRandomColor()}),e.teams[n].color=i||E.getRandomColor(),a.forEach((function(t){t in e.teams||(e.teams[t]={side:t,allies:[],enemiesTeam:[],color:E.getRandomColor()}),e.teams[n].enemiesTeam.push(e.teams[t])})),r.forEach((function(t){e.addHexEntity(t.pos,e.teams[n],t.dir)}))}));var a=document.getElementById("btn-start");null==a||a.addEventListener("click",(function(){e.startBattle()})),canvas.addEventListener("click",this.mouseClickHandler.bind(this))}return t.prototype.addHexEntity=function(t,e,n){void 0===n&&(n=1);var r=new U(Y(Y({battle:this},this.board[t.y][t.x]),{team:e}));r.owner=new B({hex:r,dir:n}),e.allies.push(r)},t.prototype.startBattle=function(){return J(this,void 0,void 0,(function(){var t,e;return Q(this,(function(n){switch(n.label){case 0:t=this.getAllTeamMembers(),n.label=1;case 1:return[4,t[e=0].owner.action()];case 2:return n.sent(),e=e>=t.length?0:e+1,[3,1];case 3:return[2]}}))}))},t.prototype.mouseClickHandler=function(t){var e;return J(this,void 0,void 0,(function(){var n,r,a,i,o,s,c,u;return Q(this,(function(l){switch(l.label){case 0:return this.canAction?(n=t.shiftKey,r=b.pixelToHex(k.mouseCam(t)),a=r.r,i=r.q,o=b.axialToStore({r:a,q:i}),s=o.x,c=o.y,a>=this.board.length||a<0?[2]:n?(this.board[s][c].block=!this.board[s][c].block,[2]):this.select?b.axialEqual(this.select,{r:a,q:i})?(this.select=null,[2]):this.board[s][c].block?[3,2]:(this.canAction=!1,(u=b.axialToStore(this.select)).x,u.y,[4,this.select.move(this.path)]):[3,3]):[2];case 1:l.sent(),this.select=null,this.canAction=!0,l.label=2;case 2:return[3,4];case 3:null===(e=this.getAllTeamMembers().find((function(t){return b.axialEqual(t,{r:a,q:i})})))||void 0===e||e.owner.action(),l.label=4;case 4:return[2]}}))}))},t.prototype.getAllTeamMembers=function(){return Object.values(this.teams).map((function(t){return t.allies})).flat()},t.prototype.mouseMoveHandler=function(t){var e,n,r;if(this.select&&this.canAction){var a=b.pixelToHex(k.mouseCam(t)),i=b.axialToStore(a),o=i.x,s=i.y;if(!(o>=this.board.length||o<0||s<0||s>=this.board[o].length||(null===(e=this.board[o][s])||void 0===e?void 0:e.block))){var c=new U(Y({battle:this},this.board[o][s]));c.r===(null===(n=this.hover)||void 0===n?void 0:n.r)&&c.q===(null===(r=this.hover)||void 0===r?void 0:r.q)||(this.hover=c,this.path=x.search(this.board,this.select,this.hover),this.path.splice(0,1))}}},t.prototype.render=function(){var t,e,n,r=this.getAllTeamMembers();null===(t=this.board)||void 0===t||t.map((function(t){null==t||t.map((function(t){var e=b.hexToPixel(t),n=e.x,r=e.y,a="white";t.block&&(a="gray"),P.drawHex({x:n,y:r,size:HEX_SIZE},a)}))})),r.sort((function(t,e){return t.r>e.r?1:t.r<e.r?-1:0})).forEach((function(t){var e;t.render(),null===(e=null==t?void 0:t.owner)||void 0===e||e.render()})),(null===(e=this.path)||void 0===e?void 0:e.length)&&(null===(n=this.path)||void 0===n||n.forEach((function(t){var e=b.hexToPixel(t),n=e.x,r=e.y;P.drawHex({x:n,y:r,size:.3*HEX_SIZE},"orange")})))},t}();const et=tt;var nt={resize:function(){var t=canvas.parentElement;if(t){var e=t.getBoundingClientRect(),n=e.width,r=e.height;canvas.width=n,canvas.height=r}},getCenter:function(){return{x:canvas.width/2,y:canvas.height/2}}};const rt=nt;var at,it,ot;!function(t){t.TOP="top",t.LEFT="left",t.RIGHT="right",t.DOWN="down"}(ot||(ot={}));var st=((at={})[ot.TOP]={isPress:!1},at[ot.LEFT]={isPress:!1},at[ot.RIGHT]={isPress:!1},at[ot.DOWN]={isPress:!1},at),ct=((it={})[ot.TOP]=["KeyW"],it[ot.LEFT]=["KeyA"],it[ot.RIGHT]=["KeyD"],it[ot.DOWN]=["KeyS"],it),ut=function(){function t(){}return t.isPress=function(t){return this.keyboardStatus[t].isPress},t.bindEvent=function(){window.addEventListener("keydown",this.bindKey),window.addEventListener("keyup",this.bindKey)},t.unbindEvent=function(){window.removeEventListener("keydown",this.bindKey),window.removeEventListener("keyup",this.bindKey)},t.bindKey=function(e){var n=e.type,r=e.code,a=Object.entries(t.keyboardMapping).find((function(t){return t[0],t[1].includes(r)}));a&&(t.keyboardStatus[a[0]].isPress="keydown"===n)},t.keyboardMapping=ct,t.keyboardStatus=st,t}();const lt=ut;n(601);var ht=n(379),ft=n.n(ht),dt=n(795),pt=n.n(dt),vt=n(569),mt=n.n(vt),bt=n(565),yt=n.n(bt),xt=n(216),gt=n.n(xt),wt=n(589),_t=n.n(wt),Tt=n(426),Et={};Et.styleTagTransform=_t(),Et.setAttributes=yt(),Et.insert=mt().bind(null,"head"),Et.domAPI=pt(),Et.insertStyleElement=gt(),ft()(Tt.Z,Et),Tt.Z&&Tt.Z.locals&&Tt.Z.locals;var St=document.createElement("canvas");n.g.canvas=St,n.g.ctx=St.getContext("2d"),n.g.cameraSpeed=1e3,n.g.animCallback=[];var At=document.createElement("div");At.id="app",At.appendChild(St);var kt=document.createElement("button");kt.innerText="START",kt.id="btn-start",document.body.appendChild(At);var Mt=new et([]),Ct=function(){var t=(new Date).getTime();n.g.deltaTime=t-n.g.prev,n.g.prev=t,animCallback.forEach((function(t,e){t.generator.next().done&&(t.onDone(),animCallback.splice(e,1))})),function(){var t=+lt.isPress(ot.RIGHT)-+lt.isPress(ot.LEFT),e=+lt.isPress(ot.DOWN)-+lt.isPress(ot.TOP);if(t||e){var r=cameraSpeed*n.g.deltaTime/1e3/n.g.cam.zoom;k.move({x:t*r,y:e*r})}}(),P.clearScreen(),ctx.font="30px Arial",ctx.strokeStyle="white",ctx.strokeText("FPS: ".concat(Math.floor(n.g.deltaTime/1e3*3600)),10,40),Mt.render(),window.requestAnimationFrame(Ct)};n.g.prev=(new Date).getTime(),rt.resize(),k.focus({x:300,y:200}),lt.bindEvent(),window.addEventListener("resize",rt.resize),window.addEventListener("wheel",(function(t){k.zoom(t)})),window.requestAnimationFrame(Ct)},322:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _constants_StatConstants__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(699),_Stat__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(634),__extends=(extendStatics=function(t,e){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},extendStatics(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),extendStatics,ComplexStat=function(_super){function ComplexStat(t){var e=t.name,n=t.value,r=_super.call(this,{name:e,value:0})||this;return r.calcHighStat(n),r.calcFinalValue(),r}return __extends(ComplexStat,_super),ComplexStat.prototype.calcHighStat=function(stats){var formula=_constants_StatConstants__WEBPACK_IMPORTED_MODULE_0__.ZP.COMPLEX_STAT_FORMULA[this.name],result=formula.replace(/{(\w+)}/g,(function(t,e){return"".concat(stats[e].finalValue)}));this.baseValue=Math.round(eval(result)||0)},ComplexStat}(_Stat__WEBPACK_IMPORTED_MODULE_1__.Z);const __WEBPACK_DEFAULT_EXPORT__=ComplexStat},634:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});const r=function(){function t(t){var e=t.name,n=t.value;this.addModifier=[],this.ampModifier=[],this.name=e,this.baseValue=n,this.calcFinalValue()}return t.prototype.setValue=function(t){return this.baseValue=t,this.calcFinalValue()},t.prototype.calcFinalValue=function(){var t,e,n=null===(t=this.addModifier)||void 0===t?void 0:t.reduce((function(t,e){return t+e.value}),0),r=null===(e=this.ampModifier)||void 0===e?void 0:e.reduce((function(t,e){return t+e.value}),0);return this.finalValue=this.baseValue*(1+r/100)+n,this.finalValue},t}()}},t=>{t(t.s=76)}]);